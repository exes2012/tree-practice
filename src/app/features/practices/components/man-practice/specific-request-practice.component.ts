import { Component } from '@angular/core';
import { CommonModule } from '@angular/common';
import { FormsModule } from '@angular/forms';
import { PracticeLayoutComponent } from '@app/shared/components/practice-layout/practice-layout.component';
import { PracticeService } from '@app/core/services/practice.service';

@Component({
  selector: 'app-specific-request-practice',
  templateUrl: './specific-request-practice.component.html',
  styleUrls: ['./specific-request-practice.component.scss'],
  standalone: true,
  imports: [CommonModule, FormsModule, PracticeLayoutComponent]
})
export class SpecificRequestPracticeComponent {
  practiceTitle = 'Работа с конкретным запросом';
  practiceSubtitle = 'Прояснение и разрешение';
  description = 'Это упражнение направлено на проработку конкретного запроса или проблемы через призму каббалистических знаний. Цель - получить ясное видение ситуации и найти пути ее разрешения.';
  time = '25 мин';
  level = 'Продвинутый';
  showTimer = false;

  userProblem = '';

  practiceSteps = [
    { title: 'Шаг 1: Ощущение', instruction: 'Почувствуй пространство, себя, свое тело.' },
    { title: 'Шаг 2: Определение проблемы', instruction: 'С чем бы ты хотел поработать?' },
    { title: 'Шаг 3: Локализация проблемы', instruction: 'Почувствуй ярко проблему. Найди, где она ощущается в теле. Ее размер, форму. Найди, она внутри или снаружи тела. Покажи рукой в это место.' },
    { title: 'Шаг 4: Самоотмена', instruction: 'Положи руку туда, где находится это чувство. Одновременно с этим поставь руку на грудную точку и проговаривай до состояния уменьшения важности и самоотмены. <br><br><strong>"Мне не важно, решится эта проблема, или нет. Мне нужна только связь с Творцом. И я здесь только для того, чтобы с ним соединиться через эту проблему."</strong> <br><br>', repeatablePhrase: 'Мне не важно, решится эта проблема, или нет. Мне нужна только связь с Творцом. И я здесь только для того, чтобы с ним соединиться через эту проблему.' },
    { title: 'Шаг 5: Единение со страдающими', instruction: 'Попытайся почувствовать все души в общей системе, которые страдают от такой же проблемы. Скажи: <br><br><strong>"Все души в общей системе, у которых есть подобная проблема, отпечатаны во мне. Связаны со мной. Мы все - часть одной общей системы.".</strong>', repeatablePhrase: 'Все души в общей системе, у которых есть подобная проблема, отпечатаны во мне. Связаны со мной. Мы все - часть одной общей системы.' },
    { title: 'Шаг 6: Проводник света', instruction: 'Попроси у Творца, чтобы он заполнил нехватки этих душ светом. Работай как проводник. Поднимай просьбу к Творцу, получай свет, и протягивая свет от него внутрь их нехваток. До состояния восполнения их нехваток. <br><br><strong>"Творец, исправь их сосуды и заполни их светом.</strong>', repeatablePhrase: 'Творец, исправь их сосуды и заполни их светом.' },
    { title: 'Шаг 7: Видение участников', instruction: 'Попроси Творца показать, какие еще участники вовлечены в эту проблему.' },
    { title: 'Шаг 8: Свет вместо тьмы', instruction: 'Почувствуй, что любое зло, любое страдание в людях это недостаток света. Тьмы не создано. Создан недостаток света. Почувствуй, где у всех участников проблемы находится недостаток света. <br><br><strong>"Творец, исправь их сосуды и заполни их светом."</strong>', repeatablePhrase: 'Творец, исправь их сосуды и заполни их светом.' },
    { title: 'Шаг 9: Соединение', instruction: 'Отметь, какими ты видишь участников, вовлеченных в проблему. Каким или какой ты видишь себя. Каким ты видишь Творца в отношении этой проблемы. Проси Творца исправить твое восприятие на альтруистическое. <br><br><strong>"Творец, исправь мои сосуды и заполни их светом."</strong>', repeatablePhrase: 'Творец, исправь мои сосуды и заполни их светом.' },
    { title: 'Шаг 10: Соединение', instruction: 'Почувствуй ещё раз всех участников, вовлечённых в эту проблему, все их сосуды. Собери все их сосуды воедино, как собрание всех душ. Подними их в точку, где ощущается Творец, и удерживай его там. Скажи: <br><br><strong>"Все, что существует - и есть Творец.".</strong> И побудь в этом состоянии.', repeatablePhrase: 'Все, что существует - и есть Творец.' },
    { title: 'Шаг 11: Благодарность', instruction: 'Вырази благодарность Творцу в меру получения облегчения и изменения. <br><br><strong>"Благодарю за это общение".</strong>' },
    { title: 'Шаг 12: Оценка', instruction: 'Во сколько баллов оценишь эту проработку?' },
  ];

  constructor(private practiceService: PracticeService) {}

  onPracticeFinished(event: { rating: number }) {
    this.practiceService.saveLastPractice({ name: this.practiceTitle, route: '/practices/man/specific-request' });
    this.practiceService.recordPracticeCompletion();
  }
}