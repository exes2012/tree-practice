<!-- Home Header -->
<app-home-header></app-home-header>

<!-- Fixed Top Section -->
<div #fixedSection class="fixed-section fixed top-0 left-0 right-0 z-40 bg-gray-100 dark:bg-gray-900">
  <div class="container mx-auto px-4 pt-12 pb-4 space-y-4">
    <!-- Statistics -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-3">
      <div class="flex items-center justify-around">
        <!-- Streak -->
        <div class="flex items-center space-x-2">
          <i class="material-icons text-3xl text-orange-500">local_fire_department</i>
          <div class="flex items-baseline space-x-1.5">
            <div class="text-2xl font-bold text-gray-800 dark:text-gray-200">{{ stats.streak }}</div>
            <div class="text-sm text-gray-500 dark:text-gray-400">дней</div>
          </div>
        </div>
        <!-- Total Practices -->
        <div class="flex items-center space-x-2">
          <i class="material-icons text-3xl text-blue-500">bar_chart</i>
          <div class="flex items-baseline space-x-1.5">
            <div class="text-2xl font-bold text-gray-800 dark:text-gray-200">{{ stats.totalPractices }}</div>
            <div class="text-sm text-gray-500 dark:text-gray-400">практики</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Daily Challenge -->
    <div *ngIf="dailyChallenge" class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-3">
      <div (click)="toggleChallenge()" class="flex items-center justify-between cursor-pointer">
        <div class="flex items-center">
          <i class="material-icons text-yellow-500 dark:text-yellow-400 mr-3">flag</i>
          <h3 class="font-semibold text-sm text-gray-800 dark:text-gray-200">Намерение дня: {{ dailyChallenge.title }}</h3>
        </div>
        <svg class="w-5 h-5 text-gray-500 dark:text-gray-400 transition-transform duration-300" [class.rotate-180]="!isChallengeExpanded" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
      </div>
      <div *ngIf="isChallengeExpanded" class="mt-2 pl-9">
        <p class="text-xs text-gray-500 dark:text-gray-400 whitespace-pre-line">{{ dailyChallenge.description }}</p>
        <button (click)="clearChallenge()" class="text-xs text-red-500 hover:underline mt-2">Удалить намерение</button>
      </div>
    </div>

    <!-- Repeat Last Practice -->
    <div *ngIf="lastPractice" class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-3 flex items-center justify-between">
      <div class="flex items-center">
        <i class="material-icons text-teal-500 dark:text-teal-400 mr-3">history</i>
        <div>
          <h3 class="font-semibold text-sm text-gray-800 dark:text-gray-200">Последняя практика</h3>
          <p class="text-xs text-gray-500 dark:text-gray-400">{{ lastPractice.name }}</p>
        </div>
      </div>
      <button (click)="repeatLastPractice()" [disabled]="!lastPractice" class="bg-teal-500 hover:bg-teal-600 text-white font-semibold py-1.5 px-3 rounded-lg transition-colors text-sm disabled:opacity-50 disabled:cursor-not-allowed">
        Повторить
      </button>
    </div>
  </div>
</div>

<!-- Scrollable Practices Section -->
<div class="scrollable-section pb-24" [style.padding-top.px]="practicesTopPadding">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div (click)="navigateToPractice('basic')" class="practice-card h-20 md:h-24 bg-yellow-100 dark:bg-yellow-900 rounded-lg shadow-md p-3 flex items-center cursor-pointer hover:bg-yellow-200 dark:hover:bg-yellow-800 transition-colors relative">
      <span class="absolute top-2 right-2 inline-block text-xs font-medium px-2 py-1 rounded-md bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200">Уровень 1</span>
      <i class="material-icons text-3xl text-yellow-600 dark:text-yellow-400 mr-2">wb_sunny</i>
      <div class="flex-1">
        <h3 class="font-semibold text-base text-gray-800 dark:text-gray-200">Базовые упражнения</h3>
        <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">Настройка на свет, 4 стадии прямого света</p>
      </div>
    </div>
    <div (click)="navigateToPractice('small-state')" class="practice-card h-20 md:h-24 bg-green-100 dark:bg-green-900 rounded-lg shadow-md p-3 flex items-center cursor-pointer hover:bg-green-200 dark:hover:bg-green-800 transition-colors relative">
      <span class="absolute top-2 right-2 inline-block text-xs font-medium px-2 py-1 rounded-md bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200">Уровень 2</span>
      <i class="material-icons text-3xl text-green-500 dark:text-green-400 mr-2">self_improvement</i>
      <div class="flex-1">
        <h3 class="font-semibold text-base text-gray-800 dark:text-gray-200">Малое состояние</h3>
        <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">Умаление своего Эго перед Творцом</p>
      </div>
    </div>
    <div (click)="navigateToPractice('man')" class="practice-card h-20 md:h-24 bg-red-100 dark:bg-red-900 rounded-lg shadow-md p-3 flex items-center cursor-pointer hover:bg-red-200 dark:hover:bg-red-800 transition-colors relative">
      <span class="absolute top-2 right-2 inline-block text-xs font-medium px-2 py-1 rounded-md bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200">Уровень 2</span>
      <i class="material-icons text-3xl text-red-500 dark:text-red-400 mr-2">man</i>
      <div class="flex-1">
        <h3 class="font-semibold text-base text-gray-800 dark:text-gray-200">Большое состояние</h3>
        <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">Работа с получающими сосудами, подъем МАН</p>
      </div>
    </div>
    <div (click)="navigateToPractice('yichudim')" class="practice-card h-20 md:h-24 bg-purple-100 dark:bg-purple-900 rounded-lg shadow-md p-3 flex items-center cursor-pointer hover:bg-purple-200 dark:hover:bg-purple-800 transition-colors relative">
      <span class="absolute top-2 right-2 inline-block text-xs font-medium px-2 py-1 rounded-md bg-purple-200 dark:bg-purple-800 text-purple-800 dark:text-purple-200">Уровень 3</span>
      <i class="material-icons text-3xl text-purple-500 dark:text-purple-400 mr-2">auto_awesome</i>
      <div class="flex-1">
        <h3 class="font-semibold text-base text-gray-800 dark:text-gray-200">Ихудим</h3>
        <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">Практики слияния с Творцом</p>
      </div>
    </div>
    <div (click)="navigateToPractice('intention')" class="practice-card h-20 md:h-24 bg-indigo-100 dark:bg-indigo-900 rounded-lg shadow-md p-3 flex items-center cursor-pointer hover:bg-indigo-200 dark:hover:bg-indigo-800 transition-colors relative">
      <span class="absolute top-2 right-2 inline-block text-xs font-medium px-2 py-1 rounded-md bg-indigo-200 dark:bg-indigo-800 text-indigo-800 dark:text-indigo-200">Уровень 4</span>
      <i class="material-icons text-3xl text-indigo-500 dark:text-indigo-400 mr-2">track_changes</i>
      <div class="flex-1">
        <h3 class="font-semibold text-base text-gray-800 dark:text-gray-200">Каванот</h3>
        <p class="text-xs text-gray-600 dark:text-gray-400 mt-1">Работа в намерении по Бааль Суламу</p>
      </div>
    </div>
    <div class="h-20 md:h-24 bg-pink-100 dark:bg-pink-900 rounded-lg shadow-md p-3 flex items-center opacity-50 cursor-not-allowed">
      <i class="material-icons text-3xl text-pink-500 dark:text-pink-400 mr-2">my_location</i>
      <h3 class="font-semibold text-base text-gray-800 dark:text-gray-200">Цели с Творцом</h3>
    </div>
    <div class="h-20 md:h-24 bg-indigo-100 dark:bg-indigo-900 rounded-lg shadow-md p-3 flex items-center opacity-50 cursor-not-allowed">
      <i class="material-icons text-3xl text-indigo-500 dark:text-indigo-400 mr-2">healing</i>
      <h3 class="font-semibold text-base text-gray-800 dark:text-gray-200">Выход из падения</h3>
    </div>
  </div>
</div>