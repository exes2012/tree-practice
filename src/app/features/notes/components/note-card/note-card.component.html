<div
  role="article"
  tabindex="0"
  [attr.aria-label]="'Заметка: ' + (note.title || 'Без заголовка')"
  class="note-card group min-h-touch cursor-pointer overflow-hidden rounded-lg border border-subtle surface-elevated shadow-sm transition-all duration-200 @container hover:-translate-y-1 hover:transform hover:shadow-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:shadow-gray-900/20"
>
  <!-- Header -->
  <div class="note-header flex items-start justify-between p-4 pb-2">
    <h3
      class="note-title text-primary mr-2 line-clamp-2 flex-1 text-lg font-semibold"
    >
      {{ note.title || 'Без заголовка' }}
    </h3>

    <div
      class="note-actions flex items-center space-x-1 opacity-0 transition-opacity duration-200 md:group-hover:opacity-100"
    >
      <button
        (click)="onToggleFavorite($event)"
        [class.text-secondary]="note.isFavorite"
        [class.dark:text-secondary]="note.isFavorite"
        [class.text-muted]="!note.isFavorite"
        class="min-h-touch min-w-touch rounded-full p-1 transition-colors duration-200 hover:bg-neutral-100 focus:outline-none focus:ring-2 focus:ring-primary-500 dark:hover:bg-neutral-700"
        [attr.aria-label]="note.isFavorite ? 'Убрать из избранного' : 'Добавить в избранное'"
        [title]="note.isFavorite ? 'Убрать из избранного' : 'Добавить в избранное'"
      >
        <i class="material-icons text-sm">{{ note.isFavorite ? 'star' : 'star_border' }}</i>
      </button>

      <button
        (click)="onDelete($event)"
        class="min-h-touch min-w-touch rounded-full p-1 text-muted transition-colors duration-200 hover:bg-red-50 hover:text-red-500 focus:outline-none focus:ring-2 focus:ring-red-500 dark:hover:bg-red-900/20"
        aria-label="Удалить заметку"
        title="Удалить заметку"
      >
        <i class="material-icons text-sm">delete</i>
      </button>
    </div>
  </div>

  <!-- Content Preview -->
  <div class="note-content px-4 pb-2">
    <p class="text-secondary line-clamp-3 text-sm leading-relaxed">
      {{ getPreviewText() || 'Нет содержимого' }}
    </p>
  </div>

  <!-- Tags -->
  <div *ngIf="note.tags.length > 0" class="note-tags px-4 pb-2">
    <div class="flex flex-wrap gap-1">
      <span
        *ngFor="let tag of note.tags | slice: 0 : 3"
        class="inline-block rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"
      >
        #{{ tag }}
      </span>
      <span
        *ngIf="note.tags.length > 3"
        class="text-secondary dark:bg-neutral-700 inline-block rounded-full bg-neutral-100 px-2 py-1 text-xs font-medium"
      >
        +{{ note.tags.length - 3 }}
      </span>
    </div>
  </div>

  <!-- Footer -->
  <div
    class="note-footer flex items-center justify-between border-t border-subtle bg-neutral-50 px-4 py-3 dark:bg-neutral-700/50"
  >
    <div class="text-secondary flex items-center text-xs">
      <i class="material-icons mr-1 text-sm">access_time</i>
      <span class="hidden sm:inline">{{ getRelativeTime() }}</span>
      <span class="sm:hidden">{{ formatDate() }}</span>
    </div>

    <div class="flex items-center space-x-2">
      <!-- Favorite indicator -->
      <div
        *ngIf="note.isFavorite"
        class="text-secondary flex items-center"
        title="Избранное"
      >
        <i class="material-icons text-sm">star</i>
      </div>
    </div>
  </div>
</div>