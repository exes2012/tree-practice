<div class="note-card group bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md dark:shadow-gray-900/20 border border-gray-200 dark:border-gray-700 transition-all duration-200 hover:transform hover:-translate-y-1 cursor-pointer overflow-hidden">
  <!-- Header -->
  <div class="note-header flex items-start justify-between p-4 pb-2">
    <h3 class="note-title text-lg font-semibold text-gray-900 dark:text-gray-100 line-clamp-2 flex-1 mr-2">
      {{note.title || 'Без заголовка'}}
    </h3>
    
    <div class="note-actions flex items-center space-x-1 opacity-0 md:group-hover:opacity-100 md:opacity-0 opacity-100 transition-opacity duration-200">
      <button
        (click)="onToggleFavorite($event)"
        [class.text-gray-600]="note.isFavorite"
        [class.dark:text-gray-300]="note.isFavorite"
        [class.text-gray-400]="!note.isFavorite"
        class="p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200"
        [title]="note.isFavorite ? 'Убрать из избранного' : 'Добавить в избранное'">
        <i class="material-icons text-sm">{{note.isFavorite ? 'star' : 'star_border'}}</i>
      </button>
      
      <button
        (click)="onDelete($event)"
        class="p-1 rounded-full text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors duration-200"
        title="Удалить заметку">
        <i class="material-icons text-sm">delete</i>
      </button>
    </div>
  </div>

  <!-- Content Preview -->
  <div class="note-content px-4 pb-2">
    <p class="text-gray-600 dark:text-gray-400 text-sm line-clamp-3 leading-relaxed">
      {{getPreviewText() || 'Нет содержимого'}}
    </p>
  </div>

  <!-- Tags -->
  <div *ngIf="note.tags.length > 0" class="note-tags px-4 pb-2">
    <div class="flex flex-wrap gap-1">
      <span
        *ngFor="let tag of note.tags | slice:0:3"
        class="inline-block px-2 py-1 text-xs font-medium bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 rounded-full">
        #{{tag}}
      </span>
      <span
        *ngIf="note.tags.length > 3"
        class="inline-block px-2 py-1 text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-full">
        +{{note.tags.length - 3}}
      </span>
    </div>
  </div>

  <!-- Footer -->
  <div class="note-footer flex items-center justify-between px-4 py-3 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-200 dark:border-gray-600">
    <div class="flex items-center text-xs text-gray-500 dark:text-gray-400">
      <i class="material-icons text-sm mr-1">access_time</i>
      <span class="hidden sm:inline">{{getRelativeTime()}}</span>
      <span class="sm:hidden">{{formatDate()}}</span>
    </div>
    
    <div class="flex items-center space-x-2">
      <!-- Favorite indicator -->
      <div *ngIf="note.isFavorite" class="flex items-center text-gray-600 dark:text-gray-300" title="Избранное">
        <i class="material-icons text-sm">star</i>
      </div>

      <!-- Created vs Updated indicator -->
      <div
        *ngIf="note.createdAt !== note.updatedAt"
        class="flex items-center text-gray-400 dark:text-gray-500"
        title="Заметка была отредактирована">
        <i class="material-icons text-sm">edit</i>
      </div>
    </div>
  </div>
</div>